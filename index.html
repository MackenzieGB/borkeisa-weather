<!doctype html>
<html lang="en-GB">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>BMS â€” Borkeisa Meteorological Service</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
:root{
  --glass-bg: rgba(0,0,0,0.3);
  --glass-border: rgba(255,255,255,0.15);
  --accent: #ffd86e;
  --text: #fff;
  --muted: #b8c7db;
  --max-width:1200px;
}
*{box-sizing:border-box;}
html,body{height:100%;margin:0;font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text",Inter,sans-serif;color:var(--text);}
body{overflow-y:auto;background:linear-gradient(180deg,#071225 0%, #071225 60%);transition:background 1s ease;}
.wrap{max-width:var(--max-width);margin:28px auto;padding:24px;}
header{display:flex;align-items:center;gap:16px;margin-bottom:24px;}
header .brand{width:64px;height:64px;border-radius:16px;background:linear-gradient(135deg,#0a6cff,#00d4ff);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:24px;}
header .title{display:flex;flex-direction:column;}
header h1{margin:0;font-size:1.4rem;font-weight:700;}
header p{margin:2px 0 0;font-size:0.95rem;color:var(--muted);}
.hero{display:grid;grid-template-columns:1fr 480px;gap:24px;align-items:start;margin-bottom:24px;}
@media(max-width:980px){.hero{grid-template-columns:1fr}.stats-right{order:-1}}
.panel{background:var(--glass-bg);border:1px solid var(--glass-border);border-radius:20px;padding:20px;backdrop-filter:blur(14px) saturate(120%);box-shadow:0 10px 40px rgba(6,18,34,0.45);}
.current .temp-large{font-size:80px;font-weight:800;}
.tiles{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-top:14px;}
@media(max-width:600px){.tiles{grid-template-columns:repeat(2,1fr);}}
.tile{background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));border-radius:16px;padding:14px;text-align:center;border:1px solid rgba(255,255,255,0.05);}
.tile .k{font-size:0.85rem;color:var(--muted);}
.tile .v{font-weight:700;font-size:1.2rem;margin-top:6px;}
.stats-right{display:flex;flex-direction:column;gap:16px;}
.charts{display:grid;grid-template-columns:1fr;gap:14px;margin-top:14px;}
canvas{width:100%!important;height:220px!important;border-radius:14px;background:transparent;}
.forecast-scroll{display:flex;overflow-x:auto;gap:12px;margin-top:14px;padding-bottom:8px;}
.forecast-card{min-width:120px;background:var(--glass-bg);border-radius:16px;padding:12px;text-align:center;flex-shrink:0;border:1px solid var(--glass-border);}
.forecast-card .day{font-weight:700;font-size:0.95rem;margin-bottom:6px;}
.forecast-card .icon{font-size:28px;margin-bottom:4px;}
.forecast-card .temp{font-weight:600;font-size:1.05rem;}
.forecast-card .precip,.forecast-card .wind{font-size:0.8rem;color:var(--muted);}
footer{margin-top:28px;text-align:center;color:var(--muted);font-size:0.82rem;}
.bg{position:fixed;inset:0;z-index:-1;pointer-events:none;overflow:hidden;}
.sun{position:absolute;right:6%;top:8%;width:180px;height:180px;border-radius:50%;background:radial-gradient(circle at 30% 30%, #fff2b8, #ffd86e 40%, #ffb648 60%, rgba(255,120,0,0.05) 100%);filter:blur(26px);opacity:0;transform:scale(0.7);transition:all 1s ease;}
.cloud{position:absolute;left:-8%;top:8%;width:720px;height:260px;background:linear-gradient(#ffffff20,#ffffff06);border-radius:50%;filter:blur(36px);opacity:0;transform:translateX(-10%);animation:clouds 45s linear infinite;}
@keyframes clouds{from{transform:translateX(-10%)}to{transform:translateX(120%)}}
.rain-layer{position:absolute;inset:0;pointer-events:none;opacity:0;transition:opacity .8s ease}
.raindrop{position:absolute;width:2px;height:16px;background:linear-gradient(180deg,#ffffff60,#ffffff10);opacity:0.8;border-radius:1px;transform:translateY(-40vh)}
</style>
</head>
<body>
<div class="bg">
  <div class="sun" id="sunElem"></div>
  <div class="cloud" id="cloudElem"></div>
  <div class="rain-layer" id="rainLayer"></div>
</div>

<div class="wrap">
<header>
  <div class="brand">BMS</div>
  <div class="title">
    <h1>BMS</h1>
    <p>Live weather for central Borkeisa</p>
  </div>
</header>

<div class="hero">
<div class="panel current">
  <div id="bigTemp" class="temp-large">--Â°C</div>
  <div style="display:flex;align-items:center;gap:14px;margin-top:10px;">
    <div id="bigIcon" style="font-size:52px;">â˜€ï¸</div>
    <div>
      <div id="summary" style="color:#b8c7db">Loadingâ€¦</div>
    </div>
  </div>
  <div class="tiles">
    <div class="tile"><div class="k">Feels like</div><div class="v" id="tileFeels">--Â°C</div></div>
    <div class="tile"><div class="k">Humidity</div><div class="v" id="tileHum">--%</div></div>
    <div class="tile"><div class="k">Pressure</div><div class="v" id="tilePress">-- hPa</div></div>
    <div class="tile"><div class="k">Wind</div><div class="v" id="tileWind">-- km/h</div></div>
    <div class="tile"><div class="k">Gust</div><div class="v" id="tileGust">-- km/h</div></div>
    <div class="tile"><div class="k">UV Index</div><div class="v" id="tileUV">--</div></div>
    <div class="tile"><div class="k">Sunrise</div><div class="v" id="tileSunrise">--:--</div></div>
    <div class="tile"><div class="k">Sunset</div><div class="v" id="tileSunset">--:--</div></div>
    <div class="tile"><div class="k">Visibility</div><div class="v" id="tileVis">-- km</div></div>
  </div>
  <div class="forecast-scroll" id="forecastScroll"></div>
</div>

<aside class="stats-right">
<div class="panel charts">
  <div style="font-weight:700;margin-bottom:8px;">Temp & Humidity (24h)</div>
  <canvas id="cTempHum"></canvas>
</div>
</aside>
</div>

<footer>Â© Borkeisa Meteorological Service â€” Data via Open-Meteo</footer>
</div>

<script>
const lat=48.08557,lon=17.24383;
const weatherMap={0:{txt:'Clear',icon:'â˜€ï¸'},1:{txt:'Mainly clear',icon:'ğŸŒ¤ï¸'},2:{txt:'Partly cloudy',icon:'â›…'},3:{txt:'Overcast',icon:'â˜ï¸'},45:{txt:'Fog',icon:'ğŸŒ«ï¸'},48:{txt:'Fog',icon:'ğŸŒ«ï¸'},51:{txt:'Drizzle',icon:'ğŸŒ¦ï¸'},53:{txt:'Drizzle',icon:'ğŸŒ¦ï¸'},55:{txt:'Dense drizzle',icon:'ğŸŒ§ï¸'},61:{txt:'Rain',icon:'ğŸŒ§ï¸'},63:{txt:'Rain',icon:'ğŸŒ§ï¸'},65:{txt:'Heavy rain',icon:'â›ˆï¸'},71:{txt:'Snow',icon:'ğŸŒ¨ï¸'},73:{txt:'Snow',icon:'ğŸŒ¨ï¸'},75:{txt:'Heavy snow',icon:'â„ï¸'},80:{txt:'Rain showers',icon:'ğŸŒ§ï¸'},81:{txt:'Moderate showers',icon:'ğŸŒ§ï¸'},82:{txt:'Violent showers',icon:'â›ˆï¸'},95:{txt:'Thunderstorm',icon:'â›ˆï¸'},99:{txt:'Severe storm',icon:'ğŸŒ©ï¸'}};

const bigTemp=document.getElementById('bigTemp');
const bigIcon=document.getElementById('bigIcon');
const summary=document.getElementById('summary');
const tileWind=document.getElementById('tileWind');
const tileHum=document.getElementById('tileHum');
const tilePress=document.getElementById('tilePress');
const tileSunrise=document.getElementById('tileSunrise');
const tileSunset=document.getElementById('tileSunset');
const tileUpdate=document.getElementById('tileUpdate');
const tileFeels=document.getElementById('tileFeels');
const tileGust=document.getElementById('tileGust');
const tileUV=document.getElementById('tileUV');
const tileVis=document.getElementById('tileVis');
const forecastScroll=document.getElementById('forecastScroll');

let tempHumChart=null;

function spawnRain(count=60){
  const container=document.getElementById('rainLayer');
  container.innerHTML='';
  for(let i=0;i<count;i++){
    const el=document.createElement('div');el.className='raindrop';
    el.style.left=Math.random()*100+'%';
    el.style.top=Math.random()*100+'%';
    el.style.height=(10+Math.random()*20)+'px';
    el.style.opacity=0.3+Math.random()*0.7;
    container.appendChild(el);
  }
}

async function updateAll(){
  try{
    const url=`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&hourly=temperature_2m,relativehumidity_2m,windspeed_10m,windgusts_10m,uv_index,visibility&daily=sunrise,sunset,temperature_2m_max,temperature_2m_min,weathercode,precipitation_probability_max,windspeed_10m_max&timezone=auto`;
    const r=await fetch(url); const d=await r.json();
    const c=d.current_weather;
    bigTemp.textContent=Math.round(c.temperature)+'Â°C';
    bigIcon.textContent=(weatherMap[c.weathercode]||{icon:'â”'}).icon;
    summary.textContent=(weatherMap[c.weathercode]||{txt:'Unknown'}).txt;

    tileWind.textContent=Math.round(c.windspeed)+' km/h';
    tileHum.textContent=Math.round(d.hourly.relativehumidity_2m[0])+'%';
    tilePress.textContent='-- hPa';
    tileSunrise.textContent=d.daily.sunrise[0].split('T')[1].slice(0,5);
    tileSunset.textContent=d.daily.sunset[0].split('T')[1].slice(0,5);
    tileFeels.textContent=Math.round(c.temperature)+'Â°C';
    tileGust.textContent=Math.round(d.hourly.windgusts_10m[0])+' km/h';
    tileUV.textContent=Math.round(d.hourly.uv_index[0]);
    tileVis.textContent=Math.round(d.hourly.visibility[0]/1000)+' km';

    const sun=document.getElementById('sunElem');
    const cloud=document.getElementById('cloudElem');
    const rainLayer=document.getElementById('rainLayer');
    sun.style.opacity=0; cloud.style.opacity=0; rainLayer.style.opacity=0; rainLayer.innerHTML='';
    if([0,1].includes(c.weathercode)){sun.style.opacity=0.95;}
    else if([2,3].includes(c.weathercode)){cloud.style.opacity=0.6;}
    else if(c.weathercode>=51 && c.weathercode<=82){cloud.style.opacity=0.6;rainLayer.style.opacity=1; spawnRain();}

    // 7-day forecast
    forecastScroll.innerHTML='';
    for(let i=0;i<7;i++){
      const card=document.createElement('div');card.className='forecast-card';
      const date=new Date(d.daily.time[i]); const day=date.toLocaleDateString('en-GB',{weekday:'short'});
      const code=d.daily.weathercode[i];
      const precip=d.daily.precipitation_probability_max[i];
      const wind=d.daily.windspeed_10m_max[i];
      const tempMax=Math.round(d.daily.temperature_2m_max[i]);
      const tempMin=Math.round(d.daily.temperature_2m_min[i]);
      card.innerHTML=`<div class="day">${day}</div><div class="icon">${(weatherMap[code]||{icon:'â”'}).icon}</div><div class="temp">${tempMax}Â°/${tempMin}Â°</div><div class="precip">ğŸ’§ ${precip}%</div><div class="wind">ğŸ’¨ ${wind} km/h</div>`;
      forecastScroll.appendChild(card);
    }
  }catch(e){console.error(e);}
}

async function updateChart(){
  const url=`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&hourly=temperature_2m,relativehumidity_2m&timezone=auto`;
  const r=await fetch(url); const d=await r.json();
  const hours=d.hourly.time.slice(0,24).map(t=>t.split('T')[1].slice(0,5));
  const temps=d.hourly.temperature_2m.slice(0,24);
  const hums=d.hourly.relativehumidity_2m.slice(0,24);
  const ctx=document.getElementById('cTempHum').getContext('2d');
  if(!tempHumChart){tempHumChart=new Chart(ctx,{type:'line',data:{labels:hours,datasets:[{label:'Temp Â°C',data:temps,borderColor:'#ffd86e',backgroundColor:'rgba(255,216,110,0.08)',tension:0.35,pointRadius:0},{label:'Humidity %',data:hums,borderColor:'#60cfff',backgroundColor:'rgba(96,207,255,0.08)',tension:0.35,pointRadius:0}]},options:{plugins:{legend:{display:true,labels:{color:'#fff'}}},scales:{x:{display:true,ticks:{color:'#fff'}},y:{display:true,ticks:{color:'#fff'}}}}});}
  else{tempHumChart.data.labels=hours;tempHumChart.data.datasets[0].data=temps;tempHumChart.data.datasets[1].data=hums;tempHumChart.update();}
}

updateAll(); updateChart();
setInterval(()=>{updateAll();updateChart();},1000*60*5);
</script>
</body>
</html>
